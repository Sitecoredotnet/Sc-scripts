$database = "master"
$root = Get-Item -Path (@{$true="$($database):\content\home"; $false="$($database):\content"}[(Test-Path -Path "$($database):\content\home")])
$baseTemplate = Get-Item master:\templates

$props = @{
    Parameters = @(
        @{Name="root"; Title="Choose the report root"; Tooltip="Only items from this root will be returned."; }
    )
    Title = "Items With Template Report"
    Icon = "Applications/32x32/form_blue.png"
    Description = "Choose the criteria for the report."
    Width = 550
    Height = 300
    ShowHints = $true
}

$result = Read-Variable @props

if($result -eq "cancel") {
    exit
}


Get-ChildItem -Path $root.ProviderPath -Recurse |
  ForEach-Object { Add-ItemLanguage $_ -Language "en" -TargetLanguage "en-GB" -IfExist OverwriteLatest  -IgnoredFields "" }
